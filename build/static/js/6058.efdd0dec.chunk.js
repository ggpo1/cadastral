"use strict";(self.webpackChunkcadastral=self.webpackChunkcadastral||[]).push([[6058],{79347:function(e,t,r){r.d(t,{e:function(){return l}});var n,a,i,s={exports:{}};n=s,a=function(){function e(e,r,a){a=a||2;var i,s,l,u,h,f,c,y=r&&r.length,x=y?r[0]*a:e.length,v=t(e,0,x,a,!0),d=[];if(!v||v.next===v.prev)return d;if(y&&(v=o(e,r,v,a)),e.length>80*a){i=l=e[0],s=u=e[1];for(var p=a;p<x;p+=a)(h=e[p])<i&&(i=h),(f=e[p+1])<s&&(s=f),h>l&&(l=h),f>u&&(u=f);c=0!==(c=Math.max(l-i,u-s))?1/c:0}return n(v,d,a,i,s,c),d}function t(e,t,r,n,a){var i,s;if(a===B(e,t,r,n)>0)for(i=t;i<r;i+=n)s=b(i,e[i],e[i+1],s);else for(i=r-n;i>=t;i-=n)s=b(i,e[i],e[i+1],s);if(s&&_(s,s.next)){var l=s.next;M(s),s=l}return s}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!_(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{var a=n.prev;if(M(n),(n=t=a)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,o,u,h,f,c){if(e){!c&&f&&y(e,u,h,f);for(var x,v,d=e;e.prev!==e.next;)if(x=e.prev,v=e.next,f?i(e,u,h,f):a(e))t.push(x.i/o),t.push(e.i/o),t.push(v.i/o),M(e),e=v.next,d=v.next;else if((e=v)===d){c?1===c?n(e=s(r(e),t,o),t,o,u,h,f,2):2===c&&l(e,t,o,u,h,f):n(r(e),t,o,u,h,f,1);break}}}function a(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(d(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&g(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function i(e,t,r,n){var a=e.prev,i=e,s=e.next;if(g(a,i,s)>=0)return!1;for(var l=a.x<i.x?a.x<s.x?a.x:s.x:i.x<s.x?i.x:s.x,o=a.y<i.y?a.y<s.y?a.y:s.y:i.y<s.y?i.y:s.y,u=a.x>i.x?a.x>s.x?a.x:s.x:i.x>s.x?i.x:s.x,h=a.y>i.y?a.y>s.y?a.y:s.y:i.y>s.y?i.y:s.y,f=x(l,o,t,r,n),c=x(u,h,t,r,n),y=e.prevZ,v=e.nextZ;y&&y.z>=f&&v&&v.z<=c;){if(y!==e.prev&&y!==e.next&&d(a.x,a.y,i.x,i.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,v!==e.prev&&v!==e.next&&d(a.x,a.y,i.x,i.y,s.x,s.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;y&&y.z>=f;){if(y!==e.prev&&y!==e.next&&d(a.x,a.y,i.x,i.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=c;){if(v!==e.prev&&v!==e.next&&d(a.x,a.y,i.x,i.y,s.x,s.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function s(e,t,n){var a=e;do{var i=a.prev,s=a.next.next;!_(i,s)&&m(i,a,a.next,s)&&w(i,s)&&w(s,i)&&(t.push(i.i/n),t.push(a.i/n),t.push(s.i/n),M(a),M(a.next),a=e=s),a=a.next}while(a!==e);return r(a)}function l(e,t,a,i,s,l){var o=e;do{for(var u=o.next.next;u!==o.prev;){if(o.i!==u.i&&p(o,u)){var h=Z(o,u);return o=r(o,o.next),h=r(h,h.next),n(o,t,a,i,s,l),void n(h,t,a,i,s,l)}u=u.next}o=o.next}while(o!==e)}function o(e,n,a,i){var s,l,o,h=[];for(s=0,l=n.length;s<l;s++)(o=t(e,n[s]*i,s<l-1?n[s+1]*i:e.length,i,!1))===o.next&&(o.steiner=!0),h.push(v(o));for(h.sort(u),s=0;s<h.length;s++)a=r(a=f(h[s],a),a.next);return a}function u(e,t){return e.x-t.x}function h(e){if(e.next.prev===e)return e;for(var t=e;;){var r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function f(e,t){var n=function(e,t){var r,n=t,a=e.x,i=e.y,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=a&&l>s){if(s=l,l===a){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(a===s)return r;var o,u=r,h=r.x,f=r.y,y=1/0;n=r;do{a>=n.x&&n.x>=h&&a!==n.x&&d(i<f?a:s,i,h,f,i<f?s:a,i,n.x,n.y)&&(o=Math.abs(i-n.y)/(a-n.x),w(n,e)&&(o<y||o===y&&(n.x>r.x||n.x===r.x&&c(r,n)))&&(r=n,y=o)),n=n.next}while(n!==u);return r}(e,t);if(!n)return t;var a=Z(n,e),i=r(n,n.next),s=h(a);return r(s,s.next),i=h(i),h(t===n?i:t)}function c(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function y(e,t,r,n){var a=e;do{if(null===a.z&&(a.z=x(a.x,a.y,t,r,n)),a.prev.next!==a||a.next.prev!==a)return a.prev.next=a,a.next.prev=a,y(e,t,r,n);a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,r,n,a,i,s,l,o,u=1;do{for(r=e,e=null,i=null,s=0;r;){for(s++,n=r,l=0,t=0;t<u&&(l++,n=n.nextZ);t++);for(o=u;l>0||o>0&&n;)0!==l&&(0===o||!n||r.z<=n.z)?(a=r,r=r.nextZ,l--):(a=n,n=n.nextZ,o--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,u*=2}while(s>1)}(a)}function x(e,t,r,n,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function d(e,t,r,n,a,i,s,l){return(a-s)*(t-l)-(e-s)*(i-l)>=0&&(e-s)*(n-l)-(r-s)*(t-l)>=0&&(r-s)*(i-l)-(a-s)*(n-l)>=0}function p(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||_(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,n){var a=k(g(e,t,r)),i=k(g(e,t,n)),s=k(g(r,n,e)),l=k(g(r,n,t));return a!==i&&s!==l||!(0!==a||!I(e,r,t))||!(0!==i||!I(e,n,t))||!(0!==s||!I(r,e,n))||!(0!==l||!I(r,t,n))}function I(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function k(e){return e>0?1:e<0?-1:0}function w(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function Z(e,t){var r=new P(e.i,e.x,e.y),n=new P(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function b(e,t,r,n){var a=new P(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function M(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function P(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(e,t,r,n){for(var a=0,i=t,s=r-n;i<r;i+=n)a+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return a}return e.deviation=function(e,t,r,n){var a=t&&t.length,i=a?t[0]*r:e.length,s=Math.abs(B(e,0,i,r));if(a)for(var l=0,o=t.length;l<o;l++){var u=t[l]*r,h=l<o-1?t[l+1]*r:e.length;s-=Math.abs(B(e,u,h,r))}var f=0;for(l=0;l<n.length;l+=3){var c=n[l]*r,y=n[l+1]*r,x=n[l+2]*r;f+=Math.abs((e[c]-e[x])*(e[y+1]-e[c+1])-(e[c]-e[y])*(e[x+1]-e[c+1]))}return 0===s&&0===f?0:Math.abs((f-s)/s)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++)for(var s=0;s<t;s++)r.vertices.push(e[a][i][s]);a>0&&(n+=e[a-1].length,r.holes.push(n))}return r},e},void 0!==(i=a())&&(n.exports=i);var l=s.exports},79308:function(e,t,r){r.r(t),r.d(t,{default:function(){return se}});var n=r(37762),a=r(15861),i=r(15671),s=r(43144),l=r(87757),o=r(66978),u=r(92026),h=r(99201);function f(e){return 746===e||747===e||!(e<4352)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103&&!(e>=65097&&e<=65103)||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351&&!(e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=12592&&e<=12687||e>=43360&&e<=43391||e>=55216&&e<=55295||e>=4352&&e<=4607||e>=44032&&e<=55215||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12688&&e<=12703||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543&&12540!==e||e>=65280&&e<=65519&&!(65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||e>=65104&&e<=65135&&!(e>=65112&&e<=65118||e>=65123&&e<=65126)||e>=5120&&e<=5759||e>=6320&&e<=6399||e>=65040&&e<=65055||e>=19904&&e<=19967||e>=40960&&e<=42127||e>=42128&&e<=42191)}function c(e){return!(e<11904)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=65280&&e<=65519||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543||e>=65040&&e<=65055||e>=42128&&e<=42191||e>=40960&&e<=42127)}function y(e){switch(e){case 10:case 32:case 38:case 40:case 41:case 43:case 45:case 47:case 173:case 183:case 8203:case 8208:case 8211:case 8231:return!0}return!1}function x(e){switch(e){case 9:case 10:case 11:case 12:case 13:case 32:return!0}return!1}var v=r(12233),d=24,p=function(){function e(t,r,n,a,s,l,o){(0,i.Z)(this,e),this._glyphItems=t,this._maxWidth=r,this._lineHeight=n,this._letterSpacing=a,this._hAnchor=s,this._vAnchor=l,this._justify=o}return(0,s.Z)(e,[{key:"getShaping",value:function(e,t,r){for(var a=this._letterSpacing,i=this._lineHeight,s=this._justify,l=this._maxWidth,o=[],u=0,h=0,v=e.length,d=0;d<v;d++){var p,g=e.charCodeAt(d),_=r&&f(g),m=void 0,I=(0,n.Z)(this._glyphItems);try{for(I.s();!(p=I.n()).done;){if(m=p.value[g])break}}catch(q){I.e(q)}finally{I.f()}o.push({codePoint:g,x:u,y:h,vertical:_,glyphMosaicItem:m}),m&&(u+=m.metrics.advance+a)}var k=u;l>0&&(k=u/Math.max(1,Math.ceil(u/l)));for(var w=e.indexOf("\u200b")>=0,Z=[],b=0;b<v-1;b++){var M=o[b].codePoint,P=c(M);if(y(M)||P){var B=0;if(10===M)B-=1e4;else if(P&&w)B+=150;else{40!==M&&65288!==M||(B+=50);var D=o[b+1].codePoint;41!==D&&65289!==D||(B+=50)}Z.push(this._buildBreak(b+1,o[b].x,k,Z,B,!1))}}for(var V=this._optimalBreaks(this._buildBreak(v,u,k,Z,0,!0)),L=0,A=t?-i:i,T=0,S=0;S<V.length;S++){for(var E=V[S],C=T;C<E&&x(o[C].codePoint);)o[C].glyphMosaicItem=null,++C;for(var z=E-1;z>C&&x(o[z].codePoint);)o[z].glyphMosaicItem=null,--z;if(C<=z){for(var F=o[C].x,N=C;N<=z;N++)o[N].x-=F,o[N].y=h;var U=o[z].x;o[z].glyphMosaicItem&&(U+=o[z].glyphMosaicItem.metrics.advance),L=Math.max(U,L),s&&this._applyJustification(o,C,z)}T=E,h+=A}if(o.length>0){var R=V.length-1,O=(s-this._hAnchor)*L,G=(-this._vAnchor*(R+1)+.5)*i;t&&R&&(G+=R*i);var K,j=(0,n.Z)(o);try{for(j.s();!(K=j.n()).done;){var H=K.value;H.x+=O,H.y+=G}}catch(q){j.e(q)}finally{j.f()}}return o.filter((function(e){return e.glyphMosaicItem}))}},{key:"_breakScore",value:function(e,t,r,n){var a=(e-t)*(e-t);return n?e<t?a/2:2*a:a+Math.abs(r)*r}},{key:"_buildBreak",value:function(e,t,r,a,i,s){var l,o=null,u=this._breakScore(t,r,i,s),h=(0,n.Z)(a);try{for(h.s();!(l=h.n()).done;){var f=l.value,c=t-f.x,y=this._breakScore(c,r,i,s)+f.score;y<=u&&(o=f,u=y)}}catch(x){h.e(x)}finally{h.f()}return{index:e,x:t,score:u,previousBreak:o}}},{key:"_optimalBreaks",value:function(e){return e?this._optimalBreaks(e.previousBreak).concat(e.index):[]}},{key:"_applyJustification",value:function(e,t,r){for(var n=e[r],a=n.vertical?d:n.glyphMosaicItem?n.glyphMosaicItem.metrics.advance:0,i=(n.x+a)*this._justify,s=t;s<=r;s++)e[s].x-=i}}],[{key:"getTextBox",value:function(e,t){if(!e.length)return null;var r,a=1/0,i=1/0,s=0,l=0,o=(0,n.Z)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value,h=u.glyphMosaicItem.metrics.advance,f=u.x,c=u.y-17,y=f+h,x=c+t;a=Math.min(a,f),s=Math.max(s,y),i=Math.min(i,c),l=Math.max(l,x)}}catch(v){o.e(v)}finally{o.f()}return{x:a,y:i,width:s-a,height:l-i}}},{key:"getBox",value:function(e){if(!e.length)return null;var t,r=1/0,a=1/0,i=0,s=0,l=(0,n.Z)(e);try{for(l.s();!(t=l.n()).done;){var o=t.value,u=o.glyphMosaicItem.metrics,h=u.height,f=u.left,c=u.top,y=u.width,x=o.x,v=o.y-(h-Math.abs(c)),d=x+y+f,p=v+h;r=Math.min(r,x),i=Math.max(i,d),a=Math.min(a,v),s=Math.max(s,p)}}catch(g){l.e(g)}finally{l.f()}return{x:r,y:a,width:i-r,height:s-a}}},{key:"addDecoration",value:function(e,t){var r=e.length;if(0!==r){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,a=e[0].y,i=1;i<r;i++){var s=e[i];if(s.y!==a){var l=e[i-1].x+e[i-1].glyphMosaicItem.metrics.left+e[i-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:a+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new v.Z(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0,code:0}}),a=s.y,n=s.x+s.glyphMosaicItem.metrics.left}}var o=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:a+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new v.Z(4,0,4,8),metrics:{width:o-n,height:8,left:0,top:0,advance:0},page:0,code:0}})}}}]),e}(),g=r(46618),_=r(60652),m=.5,I=(0,s.Z)((function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m;(0,i.Z)(this,e),this.x=t,this.y=r,this.angle=n,this.segment=a,this.minzoom=s})),k=(0,s.Z)((function e(t,r,n,a,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:m,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:h.B1;(0,i.Z)(this,e),this.anchor=t,this.labelAngle=r,this.glyphAngle=n,this.page=a,this.alternateVerticalGlyph=s,this.minzoom=l,this.maxzoom=o})),w=(0,s.Z)((function e(t,r,n,a,s,l,o,u,h,f,c,y){(0,i.Z)(this,e),this.tl=t,this.tr=r,this.bl=n,this.br=a,this.mosaicRect=s,this.labelAngle=l,this.minAngle=o,this.maxAngle=u,this.anchor=h,this.minzoom=f,this.maxzoom=c,this.page=y})),Z=(0,s.Z)((function e(t){(0,i.Z)(this,e),this.shapes=t})),b=function(){function e(){(0,i.Z)(this,e)}return(0,s.Z)(e,[{key:"getIconPlacement",value:function(e,t,r){var n=new _.E(e.x,e.y),a=0===r.rotationAlignment,i=r.keepUpright,s=r.rotate*h.DT;a&&(s+=e.angle);var l=new Z([]);return r.allowOverlap&&r.ignorePlacement||!g.Bf||(l.iconColliders=[]),this._addIconPlacement(l,n,t,r,s),a&&i&&this._addIconPlacement(l,n,t,r,s+h.JJ),l}},{key:"_addIconPlacement",value:function(e,t,r,n,a){var i=r.pixelRatio,s=r.width/i,l=r.height/i,o=n.offset,u=o[0],f=o[1];switch(n.anchor){case 0:u-=s/2,f-=l/2;break;case 1:f-=l/2;break;case 2:u-=s,f-=l/2;break;case 3:u-=s/2;break;case 4:u-=s/2,f-=l;break;case 5:break;case 7:f-=l;break;case 6:u-=s;break;case 8:u-=s,f-=l}var c=r.rect,y=2/i,x=u-y,v=f-y,d=x+c.width/i,p=v+c.height/i,I=new _.E(x,v),k=new _.E(d,p),Z=new _.E(x,p),b=new _.E(d,v);if(0!==a){var M=Math.cos(a),P=Math.sin(a);I.rotate(M,P),k.rotate(M,P),Z.rotate(M,P),b.rotate(M,P)}var B=new w(I,b,Z,k,c,a,0,256,t,m,h.B1,0);if(e.shapes.push(B),(!n.allowOverlap||!n.ignorePlacement)&&g.Bf){var D=n.size,V=n.padding,L={xTile:t.x,yTile:t.y,dxPixels:u*D-V,dyPixels:f*D-V,hard:!n.optional,partIndex:0,width:s*D+2*V,height:l*D+2*V,angle:a,minLod:m,maxLod:h.B1};e.iconColliders.push(L)}}},{key:"getTextPlacement",value:function(e,t,r,a){var i,s=new _.E(e.x,e.y),l=a.rotate*h.DT,o=0===a.rotationAlignment,u=a.keepUpright,f=a.padding,c=m,y=o?e.angle:0,x=e.segment>=0&&o,v=a.allowOverlap&&a.ignorePlacement?null:[],g=[],I=!x,b=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,P=b,B=M,D=(x||o)&&u,V=a.size/d,L=!1,A=(0,n.Z)(t);try{for(A.s();!(i=A.n()).done;){if(i.value.vertical){L=!0;break}}}catch(Se){A.e(Se)}finally{A.f()}var T,S=0,E=0;if(!x&&L){var C=p.getTextBox(t,a.lineHeight*d);switch(a.anchor){case 1:S=C.height/2,E=-C.width/2;break;case 2:S=-C.height/2,E=C.width/2;break;case 3:S=C.height/2,E=C.width/2;break;case 4:S=-C.height/2,E=-C.width/2;break;case 5:S=C.height;break;case 7:E=-C.width;break;case 6:E=C.width;break;case 8:S=-C.height}}S+=a.offset[0]*d,E+=a.offset[1]*d;var z,F=(0,n.Z)(t);try{for(F.s();!(z=F.n()).done;){var N=z.value,U=N.glyphMosaicItem;if(U&&!U.rect.isEmpty){var R=U.rect,O=U.metrics,G=U.page;if(v&&I){if(void 0!==T&&T!==N.y){var K=void 0,j=void 0,H=void 0,q=void 0;L?(K=-B+S,j=b+E,H=B-P,q=M-b):(K=b+S,j=P+E,H=M-b,q=B-P);var W={xTile:e.x,yTile:e.y,dxPixels:K*V-f,dyPixels:j*V-f,hard:!a.optional,partIndex:1,width:H*V+2*f,height:q*V+2*f,angle:l,minLod:m,maxLod:h.B1};v.push(W),b=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,P=b,B=M}T=N.y}var J=[];if(x){var Y=.5*U.metrics.width,X=(N.x+O.left-4+Y)*V*8;if(c=this._placeGlyph(e,c,X,r,e.segment,1,N.vertical,G,J),u&&(c=this._placeGlyph(e,c,X,r,e.segment,-1,N.vertical,G,J)),c>=2)break}else J.push(new k(s,y,y,G,!1)),o&&u&&J.push(new k(s,y+h.JJ,y+h.JJ,G,!1));var Q=N.x+O.left,$=N.y-17-O.top,ee=Q+O.width,te=$+O.height,re=void 0,ne=void 0,ae=void 0,ie=void 0,se=void 0,le=void 0,oe=void 0,ue=void 0;if(!x&&L)if(N.vertical){var he=(Q+ee)/2-O.height/2,fe=($+te)/2+O.width/2;re=new _.E(-fe-4+S,he-4+E),ne=new _.E(re.x+R.width,re.y+R.height),ae=new _.E(re.x,ne.y),ie=new _.E(ne.x,re.y)}else re=new _.E(4-$+S,Q-4+E),ne=new _.E(re.x-R.height,re.y+R.width),ae=new _.E(ne.x,re.y),ie=new _.E(re.x,ne.y);else re=new _.E(Q-4+S,$-4+E),ne=new _.E(re.x+R.width,re.y+R.height),ae=new _.E(re.x,ne.y),ie=new _.E(ne.x,re.y);for(var ce=0,ye=J;ce<ye.length;ce++){var xe=ye[ce],ve=void 0,de=void 0,pe=void 0,ge=void 0;if(xe.alternateVerticalGlyph){if(!se){var _e=($+te)/2+E;se=new _.E((Q+ee)/2+S-O.height/2-4,_e+O.width/2+4),le=new _.E(se.x+R.height,se.y-R.width),oe=new _.E(le.x,se.y),ue=new _.E(se.x,le.y)}ve=se,de=oe,pe=ue,ge=le}else ve=re,de=ae,pe=ie,ge=ne;var me=$,Ie=te,ke=xe.glyphAngle+l;if(0!==ke){var we=Math.cos(ke),Ze=Math.sin(ke);ve=ve.clone(),de=de.clone(),pe=pe.clone(),ge=ge.clone(),ve.rotate(we,Ze),ge.rotate(we,Ze),de.rotate(we,Ze),pe.rotate(we,Ze)}var be=0,Me=256;if(x&&L?N.vertical?xe.alternateVerticalGlyph?(be=32,Me=96):(be=224,Me=32):(be=224,Me=96):(be=192,Me=64),g.push(new w(ve,pe,de,ge,R,xe.labelAngle,be,Me,xe.anchor,xe.minzoom,xe.maxzoom,xe.page)),v&&(!D||this._legible(xe.labelAngle)))if(I)Q<b&&(b=Q),me<P&&(P=me),ee>M&&(M=ee),Ie>B&&(B=Ie);else if(xe.minzoom<2){var Pe={xTile:e.x,yTile:e.y,dxPixels:(Q+S)*V-f,dyPixels:(me+S)*V-f,hard:!a.optional,partIndex:1,width:(ee-Q)*V+2*f,height:(Ie-me)*V+2*f,angle:ke,minLod:xe.minzoom,maxLod:xe.maxzoom};v.push(Pe)}}}}}catch(Se){F.e(Se)}finally{F.f()}if(c>=2)return null;if(v&&I){var Be,De,Ve,Le;L?(Be=-B+S,De=b+E,Ve=B-P,Le=M-b):(Be=b+S,De=P+E,Ve=M-b,Le=B-P);var Ae={xTile:e.x,yTile:e.y,dxPixels:Be*V-f,dyPixels:De*V-f,hard:!a.optional,partIndex:1,width:Ve*V+2*f,height:Le*V+2*f,angle:l,minLod:m,maxLod:h.B1};v.push(Ae)}var Te=new Z(g);return v&&v.length>0&&(Te.textColliders=v),Te}},{key:"_legible",value:function(e){var t=(0,h.Or)(e);return t<65||t>=193}},{key:"_placeGlyph",value:function(e,t,r,n,a,i,s,l,o){var u=i,f=u<0?(0,h.DQ)(e.angle+h.JJ,h._U):e.angle,c=0;r<0&&(u*=-1,r*=-1,c=h.JJ),u>0&&++a;var y=new _.E(e.x,e.y),x=n[a],v=h.B1;if(n.length<=a)return v;for(;;){var d=x.x-y.x,p=x.y-y.y,g=Math.sqrt(d*d+p*p),m=Math.max(r/g,t),I=d/g,w=p/g,Z=(0,h.DQ)(Math.atan2(w,I)+c,h._U);if(o.push(new k(y,f,Z,l,!1,m,v)),s&&o.push(new k(y,f,Z,l,!0,m,v)),m<=t)return m;y=x.clone();do{if(a+=u,n.length<=a||a<0)return m;x=n[a]}while(y.isEqual(x));var b=x.x-y.x,M=x.y-y.y,P=Math.sqrt(b*b+M*M);b*=g/P,M*=g/P,y.x-=b,y.y-=M,v=m}}}]),e}(),M=r(93433),P=r(29439),B=r(78084),D=r(48035),V=function(){function e(t,r){(0,i.Z)(this,e),this.values={};for(var n=r.keys,a=r.values;t.next();)switch(t.tag()){case 1:this.id=t.getUInt64();break;case 2:for(var s=t.getMessage(),l=this.values;!s.empty();){var o=s.getUInt32(),u=s.getUInt32();l[n[o]]=a[u]}s.release();break;case 3:this.type=t.getUInt32();break;case 4:this._pbfGeometry=t.getMessage();break;default:t.skip()}}return(0,s.Z)(e,[{key:"getGeometry",value:function(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;var t,r,n=this._pbfGeometry;this._pbfGeometry=null,e?e.reset(this.type):t=[];for(var a,i=1,s=0,l=0,o=0;!n.empty();){if(0===s){var u=n.getUInt32();i=7&u,s=u>>3}switch(s--,i){case 1:l+=n.getSInt32(),o+=n.getSInt32(),e?e.moveTo(l,o):(r&&t.push(r),(r=[]).push(new _.E(l,o)));break;case 2:l+=n.getSInt32(),o+=n.getSInt32(),e?e.lineTo(l,o):r.push(new _.E(l,o));break;case 7:e?e.close():r&&!r[0].equals(l,o)&&r.push(r[0].clone());break;default:throw n.release(),new Error("Invalid path operation")}}return e?a=e.result():(r&&t.push(r),a=t),n.release(),this._geometry=a,a}}]),e}(),L=r(60136),A=r(29388),T=r(3283),S=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(){return(0,i.Z)(this,r),t.call(this,12)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r){var n=this.array;n.push(e),n.push(t),n.push(r)}}]),r}(T.Z),E=(T.Z,function(){function e(t){for((0,i.Z)(this,e),this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(t.processMessage(e._parseValue));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return(0,s.Z)(e,[{key:"getData",value:function(){return this._pbfLayer}}],[{key:"_parseValue",value:function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null}}]),e}()),C=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,n,a,i,s,l,o,u,h,f){var c=this.array,y=T.Z.i1616to32(e,t);c.push(y);var x=31;y=T.Z.i8888to32(Math.round(x*r),Math.round(x*n),Math.round(x*a),Math.round(x*i)),c.push(y),y=T.Z.i8888to32(Math.round(x*s),Math.round(x*l),Math.round(x*o),Math.round(x*u)),c.push(y),y=T.Z.i1616to32(h,0),c.push(y),f&&c.push.apply(c,(0,M.Z)(f))}}]),r}(T.Z),z=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r){var n=this.array;n.push(T.Z.i1616to32(e,t)),r&&n.push.apply(n,(0,M.Z)(r))}}]),r}(T.Z),F=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,n,a,i,s){var l=this.array,o=this.index,u=T.Z.i1616to32(e,t);l.push(u);return u=T.Z.i8888to32(Math.round(15*r),Math.round(15*n),a,i),l.push(u),s&&l.push.apply(l,(0,M.Z)(s)),o}}]),r}(T.Z),N=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,n,a,i,s,l,o,u,f,c){var y=this.array,x=T.Z.i1616to32(e,t);y.push(x),x=T.Z.i1616to32(Math.round(8*r),Math.round(8*n)),y.push(x),x=T.Z.i8888to32(a/4,i/4,l,o),y.push(x),x=T.Z.i8888to32(0,(0,h.Or)(s),10*u,Math.min(10*f,255)),y.push(x),c&&y.push.apply(y,(0,M.Z)(c))}}]),r}(T.Z),U=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"add",value:function(e,t,r,n,a){var i=this.array,s=T.Z.i1616to32(2*e+r,2*t+n);i.push(s),a&&i.push.apply(i,(0,M.Z)(a))}}]),r}(T.Z),R=function(){function e(t,r,n){(0,i.Z)(this,e),this.layerExtent=4096,this._features=[],this.layer=t,this.zoom=r,this._spriteInfo=n,this._filter=t.getFeatureFilter()}return(0,s.Z)(e,[{key:"pushFeature",value:function(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)}},{key:"hasFeatures",value:function(){return this._features.length>0}},{key:"getResources",value:function(e,t,r){}}]),e}(),O=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e,n,a,s,l){var o;return(0,i.Z)(this,r),(o=t.call(this,e,n,a)).type=4,o._circleVertexBuffer=s,o._circleIndexBuffer=l,o}return(0,s.Z)(r,[{key:"circleIndexStart",get:function(){return this._circleIndexStart}},{key:"circleIndexCount",get:function(){return this._circleIndexCount}},{key:"processFeatures",value:function(e){var t=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;var a=this.layer,i=this.zoom;e&&e.setExtent(this.layerExtent);var s,l=(0,n.Z)(this._features);try{for(l.s();!(s=l.n()).done;){var o=s.value,u=o.getGeometry(e);if(u){var h,f=a.circleMaterial.encodeAttributes(o,i,a),c=(0,n.Z)(u);try{for(c.s();!(h=c.n()).done;){var y=h.value;if(y){var x,v=(0,n.Z)(y);try{for(v.s();!(x=v.n()).done;){var d=x.value,p=t.index;t.add(d.x,d.y,0,0,f),t.add(d.x,d.y,0,1,f),t.add(d.x,d.y,1,0,f),t.add(d.x,d.y,1,1,f),r.add(p+0,p+1,p+2),r.add(p+1,p+2,p+3),this._circleIndexCount+=6}}catch(g){v.e(g)}finally{v.f()}}}}catch(g){c.e(g)}finally{c.f()}}}}catch(g){l.e(g)}finally{l.f()}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;var t=new Uint32Array(e),r=new Int32Array(t.buffer),n=0;t[n++]=this.type,t[n++]=this.layerUIDs.length;for(var a=0;a<this.layerUIDs.length;a++)t[n++]=this.layerUIDs[a];t[n++]=this._circleIndexStart,t[n++]=this._circleIndexCount,t[n++]=this._circleVertexBuffer.array.length;for(var i=0;i<this._circleVertexBuffer.array.length;i++)r[n++]=this._circleVertexBuffer.array[i];t[n++]=this._circleIndexBuffer.array.length;for(var s=0;s<this._circleIndexBuffer.array.length;s++)t[n++]=this._circleIndexBuffer.array[s];return t.buffer}}]),r}(R),G=r(22213),K=r(79347),j=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e,n,a,s,l,o,u){var h;return(0,i.Z)(this,r),(h=t.call(this,e,n,a)).type=1,h._patternMap=new Map,h._fillVertexBuffer=s,h._fillIndexBuffer=l,h._outlineVertexBuffer=o,h._outlineIndexBuffer=u,h}return(0,s.Z)(r,[{key:"fillIndexStart",get:function(){return this._fillIndexStart}},{key:"fillIndexCount",get:function(){return this._fillIndexCount}},{key:"outlineIndexStart",get:function(){return this._outlineIndexStart}},{key:"outlineIndexCount",get:function(){return this._outlineIndexCount}},{key:"getResources",value:function(e,t,r){var a=this.layer,i=this.zoom,s=a.getPaintProperty("fill-pattern");if(s)if(s.isDataDriven){var l,o=(0,n.Z)(this._features);try{for(o.s();!(l=o.n()).done;){var u=l.value;t(s.getValue(i,u),!0)}}catch(h){o.e(h)}finally{o.f()}}else t(s.getValue(i),!0)}},{key:"processFeatures",value:function(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;var t=this.layer,r=this.zoom,a=t.fillMaterial,i=t.outlineMaterial,s=t.hasDataDrivenFill,l=t.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var o=t.getPaintProperty("fill-pattern"),u=null==o?void 0:o.isDataDriven,h=!o&&t.getPaintValue("fill-antialias",r);if(t.outlineUsesFillColor){if(h&&!t.hasDataDrivenOpacity){var f=t.getPaintValue("fill-opacity",r),c=t.getPaintValue("fill-opacity",r+1);f<1&&c<1&&(h=!1)}if(h&&!t.hasDataDrivenColor){var y=t.getPaintValue("fill-color",r),x=t.getPaintValue("fill-color",r+1);y[3]<1&&x[3]<1&&(h=!1)}}var v=this._features,d=null==e?void 0:e.validateTessellation;if(u){var p,g=[],_=(0,n.Z)(v);try{for(_.s();!(p=_.n()).done;){var m=p.value,I=o.getValue(r,m),k=this._spriteInfo[I];if(k&&k.rect){var w=a.encodeAttributes(m,r,t,k),Z=h&&l?i.encodeAttributes(m,r,t):[],b=m.getGeometry(e);g.push({ddFillAttributes:w,ddOutlineAttributes:Z,page:k.page,geometry:b}),g.sort((function(e,t){return e.page-t.page}));var M,P=(0,n.Z)(g);try{for(P.s();!(M=P.n()).done;){var B=M.value,D=B.ddFillAttributes,V=B.ddOutlineAttributes,L=B.page,A=B.geometry;this._processFeature(A,h,t.outlineUsesFillColor,D,V,d,L)}}catch(N){P.e(N)}finally{P.f()}}}}catch(N){_.e(N)}finally{_.f()}}else{var T,S=(0,n.Z)(v);try{for(S.s();!(T=S.n()).done;){var E=T.value,C=s?a.encodeAttributes(E,r,t):null,z=h&&l?i.encodeAttributes(E,r,t):null,F=E.getGeometry(e);this._processFeature(F,h,t.outlineUsesFillColor,C,z,d)}}catch(N){S.e(N)}finally{S.f()}}}},{key:"serialize",value:function(){var e=10;e+=this.layerUIDs.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),a=0;t[a++]=this.type,t[a++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[a++]=this.layerUIDs[i];t[a++]=this._fillIndexStart,t[a++]=this._fillIndexCount,t[a++]=this._outlineIndexStart,t[a++]=this._outlineIndexCount;var s=this._patternMap,l=s.size;if(t[a++]=l,l>0){var o,u=(0,n.Z)(s);try{for(u.s();!(o=u.n()).done;){var h=(0,P.Z)(o.value,2),f=h[0],c=(0,P.Z)(h[1],2),y=c[0],x=c[1];t[a++]=f,t[a++]=y,t[a++]=x}}catch(_){u.e(_)}finally{u.f()}}t[a++]=this._fillVertexBuffer.array.length;for(var v=0;v<this._fillVertexBuffer.array.length;v++)r[a++]=this._fillVertexBuffer.array[v];t[a++]=this._fillIndexBuffer.array.length;for(var d=0;d<this._fillIndexBuffer.array.length;d++)t[a++]=this._fillIndexBuffer.array[d];t[a++]=this._outlineVertexBuffer.array.length;for(var p=0;p<this._outlineVertexBuffer.array.length;p++)r[a++]=this._outlineVertexBuffer.array[p];t[a++]=this._outlineIndexBuffer.array.length;for(var g=0;g<this._outlineIndexBuffer.array.length;g++)t[a++]=this._outlineIndexBuffer.array[g];return t.buffer}},{key:"_processFeature",value:function(e,t,n,a,i,s,l){if(e){var o=e.length,u=!i||0===i.length;if(t&&(!n||u))for(var h=0;h<o;h++)this._processOutline(e[h],i);for(var f,c=0;c<o;c++){var y=r._area(e[c]);y>32?(void 0!==f&&this._processFill(e,f,a,s,l),f=[c]):y<-32&&void 0!==f&&f.push(c)}void 0!==f&&this._processFill(e,f,a,s,l)}}},{key:"_processOutline",value:function(e,t){var r,n,a,i=this._outlineVertexBuffer,s=this._outlineIndexBuffer,l=s.index,o=new _.E(0,0),u=new _.E(0,0),h=new _.E(0,0),f=-1,c=-1,y=-1,x=-1,v=-1,d=!1,p=e.length;if(!(p<2)){for(var g=e[0],m=e[p-1];p&&m.isEqual(g);)m=e[--p-1];if(!(p-0<2)){for(var I=0;I<p;++I){0===I?(r=e[p-1],n=e[0],a=e[1],o.assignSub(n,r),o.normalize(),o.rightPerpendicular()):(r=n,n=a,a=I!==p-1?e[I+1]:e[0],o.assign(u));var k=this._isClipEdge(r,n);-1===x&&(d=k),u.assignSub(a,n),u.normalize(),u.rightPerpendicular();var w=o.x*u.y-o.y*u.x;h.assignAdd(o,u),h.normalize();var Z=-h.x*-o.x+-h.y*-o.y,b=Math.abs(0!==Z?1/Z:1);b>8&&(b=8),w>=0?(y=i.add(n.x,n.y,o.x,o.y,0,1,t),-1===x&&(x=y),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),c=i.add(n.x,n.y,b*-h.x,b*-h.y,0,-1,t),-1===v&&(v=c),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),f=c,c=y,y=i.add(n.x,n.y,h.x,h.y,0,1,t),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),c=i.add(n.x,n.y,u.x,u.y,0,1,t),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y)):(y=i.add(n.x,n.y,b*h.x,b*h.y,0,1,t),-1===x&&(x=y),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),c=i.add(n.x,n.y,-o.x,-o.y,0,-1,t),-1===v&&(v=c),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),f=c,c=y,y=i.add(n.x,n.y,-h.x,-h.y,0,-1,t),f>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y),(f=i.add(n.x,n.y,-u.x,-u.y,0,-1,t))>=0&&c>=0&&y>=0&&!k&&s.add(f,c,y))}f>=0&&c>=0&&x>=0&&!d&&s.add(f,c,x),f>=0&&x>=0&&v>=0&&!d&&s.add(f,v,x),this._outlineIndexCount+=3*(s.index-l)}}}},{key:"_processFill",value:function(e,t,r,a,i){var s;t.length>1&&(s=[]);var l,o=0,u=(0,n.Z)(t);try{for(u.s();!(l=u.n()).done;){var h=l.value;0!==o&&s.push(o),o+=e[h].length}}catch(z){u.e(z)}finally{u.f()}var f,c=2*o,y=G.Z.acquire(),x=(0,n.Z)(t);try{for(x.s();!(f=x.n()).done;)for(var v=f.value,d=e[v],p=d.length,g=0;g<p;++g)y.push(d[g].x,d[g].y)}catch(z){x.e(z)}finally{x.f()}var _=(0,K.e)(y,s,2);if(K.e.deviation(y,s,2,_)>0){var m=t.map((function(t){return e[t].length})),I=(0,D.b)(y,m),k=I.buffer,w=I.vertexCount;if(w>0){for(var Z=this._fillVertexBuffer.index,b=0;b<w;b++)this._fillVertexBuffer.add(k[2*b],k[2*b+1],r);for(var M=0;M<w;M+=3){var P=Z+M;this._fillIndexBuffer.add(P,P+1,P+2)}if(void 0!==i){var B=this._patternMap,V=B.get(i);V?V[1]+=w:B.set(i,[this._fillIndexStart+this._fillIndexCount,w])}this._fillIndexCount+=w}}else{var L=_.length;if(L>0){for(var A=this._fillVertexBuffer.index,T=0;T<c;)this._fillVertexBuffer.add(y[T++],y[T++],r);for(var S=0;S<L;)this._fillIndexBuffer.add(A+_[S++],A+_[S++],A+_[S++]);if(void 0!==i){var E=this._patternMap,C=E.get(i);C?C[1]+=L:E.set(i,[this._fillIndexStart+this._fillIndexCount,L])}this._fillIndexCount+=L}}G.Z.release(y)}},{key:"_isClipEdge",value:function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)}}],[{key:"_area",value:function(e){for(var t=0,r=e.length-1,n=0;n<r;n++)t+=(e[n].x-e[n+1].x)*(e[n].y+e[n+1].y);return.5*(t+=(e[r].x-e[0].x)*(e[r].y+e[0].y))}}]),r}(R),H=r(82010),q=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e,n,a,s,l){var o;return(0,i.Z)(this,r),(o=t.call(this,e,n,a)).type=2,o._tessellationOptions={pixelCoordRatio:8,halfWidth:0,offset:0},o._patternMap=new Map,o.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_ddValues:null},o.tessellationProperties._lineVertexBuffer=s,o.tessellationProperties._lineIndexBuffer=l,o._lineTessellator=new H.z(W(o.tessellationProperties),J(o.tessellationProperties),e.canUseThinTessellation),o}return(0,s.Z)(r,[{key:"lineIndexStart",get:function(){return this._lineIndexStart}},{key:"lineIndexCount",get:function(){return this._lineIndexCount}},{key:"getResources",value:function(e,t,r){var a=this.layer,i=this.zoom,s=a.hasDataDrivenLine,l=a.getPaintProperty("line-pattern"),o=a.getPaintProperty("line-dasharray"),u=a.getLayoutProperty("line-cap");if(l||o){var h=(null==u?void 0:u.getValue(i))||0,f=null==u?void 0:u.isDataDriven;if(s){var c=null==l?void 0:l.isDataDriven,y=null==o?void 0:o.isDataDriven;if(!c&&!y)return;var x,v=(0,n.Z)(this._features);try{for(v.s();!(x=v.n()).done;){var d=x.value;t(c?l.getValue(i,d):this._getDashArrayKey(d,i,a,o,f,u,h))}}catch(g){v.e(g)}finally{v.f()}}else if(l)t(l.getValue(i));else if(o){var p=o.getValue(i);t(a.getDashKey(p,h))}}}},{key:"processFeatures",value:function(e){var t,r,a,i,s,l;this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;var o=this.layer,u=this.zoom,h=this._features,f=this._tessellationOptions,c=o.hasDataDrivenLine,y=o.lineMaterial;e&&e.setExtent(this.layerExtent);var x,v=o.getPaintProperty("line-pattern"),d=o.getPaintProperty("line-dasharray"),p=null==v?void 0:v.isDataDriven,g=null==d?void 0:d.isDataDriven,_=null!=(t=x=o.getLayoutProperty("line-cap"))&&t.isDataDriven?x:null,m=_?null:o.getLayoutValue("line-cap",u),I=m||0,k=!!_,w=null!=(r=x=o.getLayoutProperty("line-join"))&&r.isDataDriven?x:null,Z=w?null:o.getLayoutValue("line-join",u),b=null!=(a=x=o.getLayoutProperty("line-miter-limit"))&&a.isDataDriven?x:null,M=b?null:o.getLayoutValue("line-miter-limit",u),P=null!=(i=x=o.getLayoutProperty("line-round-limit"))&&i.isDataDriven?x:null,B=P?null:o.getLayoutValue("line-round-limit",u),D=null!=(s=x=o.getPaintProperty("line-width"))&&s.isDataDriven?x:null,V=D?null:o.getPaintValue("line-width",u),L=null!=(l=x=o.getPaintProperty("line-offset"))&&l.isDataDriven?x:null,A=L?null:o.getPaintValue("line-offset",u);if(p||g){var T,S=[],E=(0,n.Z)(h);try{for(E.s();!(T=E.n()).done;){var C=T.value,z=p?v.getValue(u,C):this._getDashArrayKey(C,u,o,d,k,_,I),F=this._spriteInfo[z];if(F&&F.rect){var N=y.encodeAttributes(C,u,o,F),U=C.getGeometry(e);S.push({ddAttributes:N,page:F.page,cap:_?_.getValue(u,C):m,join:w?w.getValue(u,C):Z,miterLimit:b?b.getValue(u,C):M,roundLimit:P?P.getValue(u,C):B,halfWidth:.5*(D?D.getValue(u,C):V),offset:L?L.getValue(u,C):A,geometry:U})}}}catch(ae){E.e(ae)}finally{E.f()}S.sort((function(e,t){return e.page-t.page})),f.textured=!0;for(var R=0,O=S;R<O.length;R++){var G=O[R],K=G.ddAttributes,j=G.page,H=G.cap,q=G.join,W=G.miterLimit,J=G.roundLimit,Y=G.halfWidth,X=G.offset,Q=G.geometry;f.capType=H,f.joinType=q,f.miterLimit=W,f.roundLimit=J,f.halfWidth=Y,f.offset=X,this._processFeature(Q,K,j)}}else{f.textured=!(!v&&!d),f.capType=m,f.joinType=Z,f.miterLimit=M,f.roundLimit=B,f.halfWidth=.5*V,f.offset=A;var $,ee=(0,n.Z)(h);try{for(ee.s();!($=ee.n()).done;){var te=$.value,re=c?y.encodeAttributes(te,u,o):null;_&&(f.capType=_.getValue(u,te)),w&&(f.joinType=w.getValue(u,te)),b&&(f.miterLimit=b.getValue(u,te)),P&&(f.roundLimit=P.getValue(u,te)),D&&(f.halfWidth=.5*D.getValue(u,te)),L&&(f.offset=L.getValue(u,te));var ne=te.getGeometry(e);this._processFeature(ne,re)}}catch(ae){ee.e(ae)}finally{ee.f()}}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),a=0;t[a++]=this.type,t[a++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[a++]=this.layerUIDs[i];t[a++]=this._lineIndexStart,t[a++]=this._lineIndexCount;var s=this._patternMap,l=s.size;if(t[a++]=l,l>0){var o,u=(0,n.Z)(s);try{for(u.s();!(o=u.n()).done;){var h=(0,P.Z)(o.value,2),f=h[0],c=(0,P.Z)(h[1],2),y=c[0],x=c[1];t[a++]=f,t[a++]=y,t[a++]=x}}catch(p){u.e(p)}finally{u.f()}}t[a++]=this.tessellationProperties._lineVertexBuffer.array.length;for(var v=0;v<this.tessellationProperties._lineVertexBuffer.array.length;v++)r[a++]=this.tessellationProperties._lineVertexBuffer.array[v];t[a++]=this.tessellationProperties._lineIndexBuffer.array.length;for(var d=0;d<this.tessellationProperties._lineIndexBuffer.array.length;d++)t[a++]=this.tessellationProperties._lineIndexBuffer.array[d];return t.buffer}},{key:"_processFeature",value:function(e,t,r){if(e)for(var n=e.length,a=0;a<n;a++)this._processGeometry(e[a],t,r)}},{key:"_processGeometry",value:function(e,t,r){if(!(e.length<2)){for(var n,a,i=e[0],s=1;s<e.length;)(n=e[s].x-i.x)*n+(a=e[s].y-i.y)*a<1e-6?e.splice(s,1):(i=e[s],++s);if(!(e.length<2)){var l=this.tessellationProperties._lineIndexBuffer,o=3*l.index;this._tessellationOptions.initialDistance=0,this._tessellationOptions.wrapDistance=65535,this.tessellationProperties._ddValues=t,this._lineTessellator.tessellate(e,this._tessellationOptions);var u=3*l.index-o;if(void 0!==r){var h=this._patternMap,f=h.get(r);f?f[1]+=u:h.set(r,[o+this._lineIndexCount,u])}this._lineIndexCount+=u}}}},{key:"_getDashArrayKey",value:function(e,t,r,n,a,i,s){var l=a?i.getValue(t,e):s,o=n.getValue(t,e);return r.getDashKey(o,l)}}]),r}(R),W=function(e){return function(t,r,n,a,i,s,l,o,u,h,f){return e._lineVertexBuffer.add(t,r,l,o,n,a,i,s,u,h,f,e._ddValues),e._lineVertexBuffer.index-1}},J=function(e){return function(t,r,n){e._lineIndexBuffer.add(t,r,n)}},Y=r(8961),X=r(643),Q=r(66002);function $(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page-t.iconMosaicItem.page:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}var ee=function(e){(0,L.Z)(r,e);var t=(0,A.Z)(r);function r(e,n,a,s,l,o,u,h){var f;return(0,i.Z)(this,r),(f=t.call(this,e,n,h.getSpriteItems())).type=3,f._markerMap=new Map,f._glyphMap=new Map,f._glyphBufferDataStorage=new Map,f._isIconSDF=!1,f._iconVertexBuffer=a,f._iconIndexBuffer=s,f._textVertexBuffer=l,f._textIndexBuffer=o,f._placementEngine=u,f._workerTileHandler=h,f}return(0,s.Z)(r,[{key:"markerPageMap",get:function(){return this._markerMap}},{key:"glyphsPageMap",get:function(){return this._glyphMap}},{key:"symbolInstances",get:function(){return this._symbolInstances}},{key:"getResources",value:function(e,t,a){var i=this.layer,s=this.zoom;e&&e.setExtent(this.layerExtent);var l,o,u,h,f=i.getLayoutProperty("icon-image"),c=i.getLayoutProperty("text-field"),y=i.getLayoutProperty("text-transform"),x=i.getLayoutProperty("text-font"),v=[];f&&!f.isDataDriven&&(l=f.getValue(s)),c&&!c.isDataDriven&&(o=c.getValue(s)),y&&y.isDataDriven||(u=i.getLayoutValue("text-transform",s),y=null),x&&x.isDataDriven||(h=i.getLayoutValue("text-font",s),x=null);var d,p=(0,n.Z)(this._features);try{for(p.s();!(d=p.n()).done;){var g=d.value,_=g.getGeometry(e);if(_&&0!==_.length){var m=void 0,I=void 0;f&&((m=f.isDataDriven?f.getValue(s,g):this._replaceKeys(l,g.values))&&t(m));var k=!1;if(c&&(I=c.isDataDriven?c.getValue(s,g):this._replaceKeys(o,g.values))){switch(I=I.replace(/\\n/g,"\n"),y&&(u=y.getValue(s,g)),u){case 2:I=I.toLowerCase();break;case 1:I=I.toUpperCase()}if(r._bidiEngine.hasBidiChar(I)){var w;w="rtl"===r._bidiEngine.checkContextual(I)?"IDNNN":"ICNNN",I=r._bidiEngine.bidiTransform(I,w,"VLYSN"),k=!0}var Z=I.length;if(Z>0){x&&(h=x.getValue(s,g));var b,M=(0,n.Z)(h);try{for(M.s();!(b=M.n()).done;){var P=b.value,B=a[P];B||(B=a[P]=new Set);for(var D=0;D<Z;D++){var V=I.charCodeAt(D);B.add(V)}}}catch(T){M.e(T)}finally{M.f()}}}if(m||I){var L=i.getLayoutValue("symbol-sort-key",s,g),A={feature:g,sprite:m,label:I,rtl:k,geometry:_,hash:(I?(0,X.hP)(I):0)^(m?(0,X.hP)(m):0),priority:L,textFont:h};v.push(A)}}}}catch(T){p.e(T)}finally{p.f()}this._symbolFeatures=v}},{key:"processFeatures",value:function(e){e&&e.setExtent(this.layerExtent);var t,a=this.layer,i=this.zoom,s=a.getLayoutValue("symbol-placement",i),l=0!==s,o=8*a.getLayoutValue("symbol-spacing",i),u=a.getLayoutProperty("icon-image"),f=a.getLayoutProperty("text-field"),c=u?new Q._L(a,i,l):null,y=f?new Q.nj(a,i,l):null,x=this._workerTileHandler;u&&(t=x.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var v=[],g=1;y&&y.size&&(g=y.size/d);var _,m=y?y.maxAngle*h.DT:0,k=y?8*y.size:0,w=(0,n.Z)(this._symbolFeatures);try{for(w.s();!(_=w.n()).done;){var Z=_.value,b=void 0;c&&t&&Z.sprite&&((b=t[Z.sprite])&&b.sdf&&(this._isIconSDF=!0));var M=void 0;b&&c.update(i,Z.feature);var P=0,B=Z.label;if(B){y.update(i,Z.feature);var D=l?y.keepUpright:y.writingMode&&y.writingMode.indexOf(1)>=0,V=.5;switch(y.anchor){case 5:case 1:case 7:V=0;break;case 6:case 2:case 8:V=1}var L=.5;switch(y.anchor){case 5:case 3:case 6:L=0;break;case 7:case 4:case 8:L=1}var A=.5;switch(y.justify){case 0:A=V;break;case 1:A=0;break;case 3:A=1}var T=y.letterSpacing*d,S=l?0:y.maxWidth*d,E=y.lineHeight*d,C=Z.textFont.map((function(e){return x.getGlyphItems(e)}));if((M=new p(C,S,E,T,V,L,A).getShaping(B,Z.rtl,D))&&M.length>0){var z,F=1e30,N=-1e30,U=(0,n.Z)(M);try{for(U.s();!(z=U.n()).done;){var R=z.value;F=Math.min(F,R.x),N=Math.max(N,R.x)}}catch(X){U.e(X)}finally{U.f()}P=(N-F+48)*g*8}}var O,G=(0,n.Z)(Z.geometry);try{for(G.s();!(O=G.n()).done;){var K=O.value,j=[];if(1===s){if(M&&M.length>0&&y&&y.size){var H=8*y.size*(2+Math.min(2,4*Math.abs(y.offset[1])));K=r._smoothVertices(K,H)}r._pushAnchors(j,K,o,P)}else 2===s?r._pushCenterAnchor(j,K):3===Z.feature.type?r._pushCentroid(j,K):j.push(new I(K[0].x,K[0].y));for(var q=0,W=j;q<W.length;q++){var J=W[q];if(!(J.x<0||J.x>4096||J.y<0||J.y>4096)&&(!(l&&P>0&&0===y.rotationAlignment)||r._honorsTextMaxAngle(K,J,P,m,k))){var Y={shaping:M,line:K,iconMosaicItem:b,anchor:J,symbolFeature:Z,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};v.push(Y),this._processFeature(Y,c,y)}}}}catch(X){G.e(X)}finally{G.f()}}}catch(X){w.e(X)}finally{w.f()}v.sort($),this._addPlacedGlyphs(),this._symbolInstances=v}},{key:"serialize",value:function(){var e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=r.symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;var t=new Uint32Array(e),a=new Int32Array(t.buffer),i=new Float32Array(t.buffer),s=0;t[s++]=this.type,t[s++]=this.layerUIDs.length;for(var l=0;l<this.layerUIDs.length;l++)t[s++]=this.layerUIDs[l];t[s++]=this._isIconSDF?1:0,t[s++]=this.markerPageMap.size;var o,u=(0,n.Z)(this.markerPageMap);try{for(u.s();!(o=u.n()).done;){var h=(0,P.Z)(o.value,2),f=h[0],c=(0,P.Z)(h[1],2),y=c[0],x=c[1];t[s++]=f,t[s++]=y,t[s++]=x}}catch(M){u.e(M)}finally{u.f()}t[s++]=this.glyphsPageMap.size;var v,d=(0,n.Z)(this.glyphsPageMap);try{for(d.s();!(v=d.n()).done;){var p=(0,P.Z)(v.value,2),g=p[0],_=(0,P.Z)(p[1],2),m=_[0],I=_[1];t[s++]=g,t[s++]=m,t[s++]=I}}catch(M){d.e(M)}finally{d.f()}t[s++]=this._iconVertexBuffer.index/4,t[s++]=this._textVertexBuffer.index/4,s=r.serializeSymbols(t,a,i,s,this._symbolInstances),t[s++]=this._iconVertexBuffer.array.length;for(var k=0;k<this._iconVertexBuffer.array.length;k++)a[s++]=this._iconVertexBuffer.array[k];t[s++]=this._iconIndexBuffer.array.length;for(var w=0;w<this._iconIndexBuffer.array.length;w++)t[s++]=this._iconIndexBuffer.array[w];t[s++]=this._textVertexBuffer.array.length;for(var Z=0;Z<this._textVertexBuffer.array.length;Z++)a[s++]=this._textVertexBuffer.array[Z];t[s++]=this._textIndexBuffer.array.length;for(var b=0;b<this._textIndexBuffer.array.length;b++)t[s++]=this._textIndexBuffer.array[b];return t.buffer}},{key:"_replaceKeys",value:function(e,t){return e.replace(/{([^{}]+)}/g,(function(e,r){return r in t?t[r]:""}))}},{key:"_processFeature",value:function(e,t,r){var a=e.line,i=e.iconMosaicItem,s=e.shaping,l=e.anchor,o=this.zoom,u=this.layer,f=!!i,c=!0;f&&(c=t.optional||!i);var y,x,v=s&&s.length>0,d=!0;if(v&&(d=r.optional),f&&(y=this._placementEngine.getIconPlacement(l,i,t)),(y||c)&&(v&&(x=this._placementEngine.getTextPlacement(l,s,a,r)),x||d)){if(y&&x||(d||c?d||x?c||y||(x=null):y=null:(y=null,x=null)),x){var p=u.hasDataDrivenText?u.textMaterial.encodeAttributes(e.symbolFeature.feature,o,u):null;if(this._storePlacedGlyphs(e,x.shapes,o,r.rotationAlignment,p),x.textColliders){e.textColliders=x.textColliders;var g,_=(0,n.Z)(x.textColliders);try{for(_.s();!(g=_.n()).done;){var m=g.value;m.minLod=Math.max(o+(0,h.k3)(m.minLod),0),m.maxLod=Math.min(o+(0,h.k3)(m.maxLod),25);var I=m.angle;if(I){var k=Math.cos(I),w=Math.sin(I),Z=m.dxPixels*k-m.dyPixels*w,b=m.dxPixels*w+m.dyPixels*k,M=(m.dxPixels+m.width)*k-m.dyPixels*w,P=(m.dxPixels+m.width)*w+m.dyPixels*k,B=m.dxPixels*k-(m.dyPixels+m.height)*w,D=m.dxPixels*w+(m.dyPixels+m.height)*k,V=(m.dxPixels+m.width)*k-(m.dyPixels+m.height)*w,L=(m.dxPixels+m.width)*w+(m.dyPixels+m.height)*k,A=Math.min(Z,M,B,V),T=Math.max(Z,M,B,V),S=Math.min(b,P,D,L),E=Math.max(b,P,D,L);m.dxPixels=A,m.dyPixels=S,m.width=T-A,m.height=E-S}}}catch(te){_.e(te)}finally{_.f()}}}if(y){var C=u.hasDataDrivenIcon?u.iconMaterial.encodeAttributes(e.symbolFeature.feature,o,u):null;if(this._addPlacedIcons(e,y.shapes,o,i.page,1===t.rotationAlignment,C),y.iconColliders){e.iconColliders=y.iconColliders;var z,F=(0,n.Z)(y.iconColliders);try{for(F.s();!(z=F.n()).done;){var N=z.value;N.minLod=Math.max(o+(0,h.k3)(N.minLod),0),N.maxLod=Math.min(o+(0,h.k3)(N.maxLod),25);var U=N.angle;if(U){var R=Math.cos(U),O=Math.sin(U),G=N.dxPixels*R-N.dyPixels*O,K=N.dxPixels*O+N.dyPixels*R,j=(N.dxPixels+N.width)*R-N.dyPixels*O,H=(N.dxPixels+N.width)*O+N.dyPixels*R,q=N.dxPixels*R-(N.dyPixels+N.height)*O,W=N.dxPixels*O+(N.dyPixels+N.height)*R,J=(N.dxPixels+N.width)*R-(N.dyPixels+N.height)*O,Y=(N.dxPixels+N.width)*O+(N.dyPixels+N.height)*R,X=Math.min(G,j,q,J),Q=Math.max(G,j,q,J),$=Math.min(K,H,W,Y),ee=Math.max(K,H,W,Y);N.dxPixels=X,N.dyPixels=$,N.width=Q-X,N.height=ee-$}}}catch(te){F.e(te)}finally{F.f()}}}}}},{key:"_addPlacedIcons",value:function(e,t,r,a,i,s){var l,o=Math.max(r-1,0),u=this._iconVertexBuffer,f=this._iconIndexBuffer,c=this._markerMap,y=(0,n.Z)(t);try{for(y.s();!(l=y.n()).done;){var x=l.value,v=i?0:Math.max(r+(0,h.k3)(x.minzoom),o),d=i?25:Math.min(r+(0,h.k3)(x.maxzoom),25);if(!(d<=v)){var p=x.tl,g=x.tr,_=x.bl,m=x.br,I=x.mosaicRect,k=x.labelAngle,w=x.minAngle,Z=x.maxAngle,b=x.anchor,M=u.index,P=I.x,B=I.y,D=P+I.width,V=B+I.height,L=u.index;u.add(b.x,b.y,p.x,p.y,P,B,k,w,Z,v,d,s),u.add(b.x,b.y,g.x,g.y,D,B,k,w,Z,v,d,s),u.add(b.x,b.y,_.x,_.y,P,V,k,w,Z,v,d,s),u.add(b.x,b.y,m.x,m.y,D,V,k,w,Z,v,d,s),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===L?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([L,4]),f.add(M+0,M+1,M+2),f.add(M+1,M+2,M+3),c.has(a)?c.get(a)[1]+=6:c.set(a,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}}catch(A){y.e(A)}finally{y.f()}}},{key:"_addPlacedGlyphs",value:function(){var e,t=this._textVertexBuffer,r=this._textIndexBuffer,a=this._glyphMap,i=(0,n.Z)(this._glyphBufferDataStorage);try{for(i.s();!(e=i.n()).done;){var s,l=(0,P.Z)(e.value,2),o=l[0],u=l[1],h=(0,n.Z)(u);try{for(h.s();!(s=h.n()).done;){var f=s.value,c=t.index,y=f.symbolInstance,x=f.ddAttributes,v=t.index;t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.tl[0],f.tl[1],f.xmin,f.ymin,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,x),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.tr[0],f.tr[1],f.xmax,f.ymin,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,x),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.bl[0],f.bl[1],f.xmin,f.ymax,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,x),t.add(f.glyphAnchor[0],f.glyphAnchor[1],f.br[0],f.br[1],f.xmax,f.ymax,f.labelAngle,f.minAngle,f.maxAngle,f.minLod,f.maxLod,x),y.textVertexRanges.length>0&&y.textVertexRanges[0][0]+y.textVertexRanges[0][1]===v?y.textVertexRanges[0][1]+=4:y.textVertexRanges.push([v,4]),r.add(c+0,c+1,c+2),r.add(c+1,c+2,c+3),a.has(o)?a.get(o)[1]+=6:a.set(o,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}}catch(d){h.e(d)}finally{h.f()}}}catch(d){i.e(d)}finally{i.f()}this._glyphBufferDataStorage.clear()}},{key:"_storePlacedGlyphs",value:function(e,t,r,a,i){var s,l,o,u,f,c,y,x,v,d,p,g,_=Math.max(r-1,0),m=1===a,I=(0,n.Z)(t);try{for(I.s();!(g=I.n()).done;){var k=g.value;(s=m?0:Math.max(r+(0,h.k3)(k.minzoom),_),(l=m?25:Math.min(r+(0,h.k3)(k.maxzoom),25))<=s)||(o=k.tl,u=k.tr,f=k.bl,c=k.br,y=k.labelAngle,x=k.minAngle,v=k.maxAngle,d=k.anchor,p=k.mosaicRect,this._glyphBufferDataStorage.has(k.page)||this._glyphBufferDataStorage.set(k.page,[]),this._glyphBufferDataStorage.get(k.page).push({glyphAnchor:[d.x,d.y],tl:[o.x,o.y],tr:[u.x,u.y],bl:[f.x,f.y],br:[c.x,c.y],xmin:p.x,ymin:p.y,xmax:p.x+p.width,ymax:p.y+p.height,labelAngle:y,minAngle:x,maxAngle:v,minLod:s,maxLod:l,placementLod:_,symbolInstance:e,ddAttributes:i}))}}catch(w){I.e(w)}finally{I.f()}}}],[{key:"symbolsSerializationLength",value:function(e){var t=0;t+=1;var r,a=(0,n.Z)(e||[]);try{for(a.s();!(r=a.n()).done;){var i=r.value;t+=4,t+=1;var s,l=(0,n.Z)(i.textColliders);try{for(l.s();!(s=l.n()).done;){s.value;t+=10}}catch(h){l.e(h)}finally{l.f()}var o,u=(0,n.Z)(i.iconColliders);try{for(u.s();!(o=u.n()).done;){o.value;t+=10}}catch(h){u.e(h)}finally{u.f()}t+=1,t+=2*i.textVertexRanges.length,t+=1,t+=2*i.iconVertexRanges.length}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"serializeSymbols",value:function(e,t,r,a,i){i=i||[],t[a++]=i.length;var s,l=(0,n.Z)(i);try{for(l.s();!(s=l.n()).done;){var o=s.value;t[a++]=o.anchor.x,t[a++]=o.anchor.y,t[a++]=o.symbolFeature.hash,t[a++]=o.symbolFeature.priority,t[a++]=o.textColliders.length+o.iconColliders.length;var u,h=(0,n.Z)(o.textColliders);try{for(h.s();!(u=h.n()).done;){var f=u.value;t[a++]=f.xTile,t[a++]=f.yTile,t[a++]=f.dxPixels,t[a++]=f.dyPixels,t[a++]=f.hard?1:0,t[a++]=f.partIndex,r[a++]=f.minLod,r[a++]=f.maxLod,t[a++]=f.width,t[a++]=f.height}}catch(b){h.e(b)}finally{h.f()}var c,y=(0,n.Z)(o.iconColliders);try{for(y.s();!(c=y.n()).done;){var x=c.value;t[a++]=x.xTile,t[a++]=x.yTile,t[a++]=x.dxPixels,t[a++]=x.dyPixels,t[a++]=x.hard?1:0,t[a++]=x.partIndex,r[a++]=x.minLod,r[a++]=x.maxLod,t[a++]=x.width,t[a++]=x.height}}catch(b){y.e(b)}finally{y.f()}t[a++]=o.textVertexRanges.length;var v,d=(0,n.Z)(o.textVertexRanges);try{for(d.s();!(v=d.n()).done;){var p=(0,P.Z)(v.value,2),g=p[0],_=p[1];t[a++]=g,t[a++]=_}}catch(b){d.e(b)}finally{d.f()}t[a++]=o.iconVertexRanges.length;var m,I=(0,n.Z)(o.iconVertexRanges);try{for(I.s();!(m=I.n()).done;){var k=(0,P.Z)(m.value,2),w=k[0],Z=k[1];t[a++]=w,t[a++]=Z}}catch(b){I.e(b)}finally{I.f()}}}catch(b){l.e(b)}finally{l.f()}return a}},{key:"_pushAnchors",value:function(e,t,r,n){r+=n;for(var a=0,i=t.length-1,s=0;s<i;s++)a+=_.E.distance(t[s],t[s+1]);var l=n||r;if(!(a<=(l*=.5)))for(var o=l/a,u=0,f=-(r=a/Math.max(Math.round(a/r),1))/2,c=t.length-1,y=0;y<c;y++){for(var x=t[y],v=t[y+1],d=v.x-x.x,p=v.y-x.y,g=Math.sqrt(d*d+p*p),m=void 0;f+r<u+g;){var k=((f+=r)-u)/g,w=(0,h.sX)(x.x,v.x,k),Z=(0,h.sX)(x.y,v.y,k);void 0===m&&(m=Math.atan2(p,d)),e.push(new I(w,Z,m,y,o))}u+=g}}},{key:"_pushCenterAnchor",value:function(e,t){for(var r=0,n=t.length-1,a=0;a<n;a++)r+=_.E.distance(t[a],t[a+1]);for(var i=r/2,s=0,l=t.length-1,o=0;o<l;o++){var u=t[o],f=t[o+1],c=f.x-u.x,y=f.y-u.y,x=Math.sqrt(c*c+y*y);if(i<s+x){var v=(i-s)/x,d=(0,h.sX)(u.x,f.x,v),p=(0,h.sX)(u.y,f.y,v),g=Math.atan2(y,c);return void e.push(new I(d,p,g,o,0))}s+=x}}},{key:"_deviation",value:function(e,t,r){var n=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),a=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(a,n)}},{key:"_honorsTextMaxAngle",value:function(e,t,r,n,a){for(var i=0,s=r/2,l=new _.E(t.x,t.y),o=t.segment+1;i>-s;){if(--o<0)return!1;i-=_.E.distance(e[o],l),l=e[o]}i+=_.E.distance(e[o],e[o+1]);for(var u=[],h=0,f=e.length;i<s;){var c=e[o],y=void 0,x=o;do{if(++x===f)return!1;y=e[x]}while(y.isEqual(c));var v=void 0,d=x;do{if(++d===f)return!1;v=e[d]}while(v.isEqual(y));var p=this._deviation(c,y,v);for(u.push({deviation:p,distToAnchor:i}),h+=p;i-u[0].distToAnchor>a;)h-=u.shift().deviation;if(Math.abs(h)>n)return!1;i+=_.E.distance(y,v),o=x}return!0}},{key:"_smoothVertices",value:function(e,t){if(t<=0)return e;var r=e.length;if(r<3)return e;var n=[],a=0,i=0;n.push(0);for(var s=1;s<r;s++){var l=_.E.distance(e[s],e[s-1]);l>0&&(a+=l,n.push(a),++i!==s&&(e[i]=e[s]))}if((r=i+1)<3)return e;t=Math.min(t,.2*a);var o=e[0].x,u=e[0].y,h=e[r-1].x,f=e[r-1].y,c=_.E.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y,n[0]-=t,n[r-1]+=t;var y=[];y.push(new _.E(o,u));for(var x=1e-6,v=.5*t,d=1;d<r-1;d++){for(var p=0,g=0,m=0,I=d-1;I>=0;I--){var k=v+n[I+1]-n[d];if(k<0)break;var w=n[I+1]-n[I],Z=n[d]-n[I]<v?1:k/w;if(Z<x)break;var b=Z*Z,M=Z*k-.5*b*w,P=Z*w/t,B=e[I+1],D=e[I].x-B.x,V=e[I].y-B.y;p+=P/M*(B.x*Z*k+.5*b*(k*D-w*B.x)-b*Z*w*D/3),g+=P/M*(B.y*Z*k+.5*b*(k*V-w*B.y)-b*Z*w*V/3),m+=P}for(var L=d+1;L<r;L++){var A=v-n[L-1]+n[d];if(A<0)break;var T=n[L]-n[L-1],S=n[L]-n[d]<v?1:A/T;if(S<x)break;var E=S*S,C=S*A-.5*E*T,z=S*T/t,F=e[L-1],N=e[L].x-F.x,U=e[L].y-F.y;p+=z/C*(F.x*S*A+.5*E*(A*N-T*F.x)-E*S*T*N/3),g+=z/C*(F.y*S*A+.5*E*(A*U-T*F.y)-E*S*T*U/3),m+=z}y.push(new _.E(p/m,g/m))}return y.push(new _.E(h,f)),e[0].x=o,e[0].y=u,e[r-1].x=h,e[r-1].y=f,y}},{key:"_pushCentroid",value:function(e,t){var r=4096,n=4096,a=t.length-1,i=0,s=0,l=0,o=t[0].x,u=t[0].y;o>r&&(o=r),o<0&&(o=0),u>n&&(u=n),u<0&&(u=0);for(var h=1;h<a;h++){var f=t[h].x,c=t[h].y,y=t[h+1].x,x=t[h+1].y;f>r&&(f=r),f<0&&(f=0),c>n&&(c=n),c<0&&(c=0),y>r&&(y=r),y<0&&(y=0),x>n&&(x=n),x<0&&(x=0);var v=(f-o)*(x-u)-(y-o)*(c-u);i+=v*(o+f+y),s+=v*(u+c+x),l+=v}i/=3*l,s/=3*l,isNaN(i)||isNaN(s)||e.push(new I(i,s))}}]),r}(R);ee._bidiEngine=new Y.Z;var te,re=r(91623);!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(te||(te={}));var ne=function(){function e(t,r,a,s,l){if((0,i.Z)(this,e),this._pbfTiles={},this._tileClippers={},this._client=a,this._tile=r,l){this._styleLayerUIDs=new Set;var o,u=(0,n.Z)(l);try{for(u.s();!(o=u.n()).done;){var h=o.value;this._styleLayerUIDs.add(h)}}catch(M){u.e(M)}finally{u.f()}}this._styleRepository=s,this._layers=this._styleRepository.layers;var f=r.tileKey.split("/").map(parseFloat),c=(0,P.Z)(f,3),y=c[0],x=c[1],v=c[2];this._level=y;for(var d=8+Math.max(5*(this._level-14),0),p=0,g=Object.keys(t);p<g.length;p++){var _=g[p],m=t[_];if(this._pbfTiles[_]=new B.Z(new Uint8Array(m.protobuff),new DataView(m.protobuff)),m.refKey){var I=m.refKey.split("/").map(parseFloat),k=y-(0,P.Z)(I,1)[0];if(k>0){var w=(1<<k)-1,Z=x&w,b=v&w;this._tileClippers[_]=new re.b(k,Z,b,8,d)}}this._tileClippers[_]||(this._tileClippers[_]=new re.I)}}return(0,s.Z)(e,[{key:"_canParseStyleLayer",value:function(e){return!this._styleLayerUIDs||this._styleLayerUIDs.has(e)}},{key:"parse",value:function(){var e=(0,a.Z)(l.mark((function e(t){var r,a,i,s,o,u,h,f,c,y,x,v=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,D.j)(),a=this._initialize(t),i=a.returnedBuckets,this._processLayers(a),this._linkReferences(a),this._filterFeatures(a),s=[],o=new Set,u=function(e,t){o.has(e)||(s.push({name:e,repeat:t}),o.add(e))},h={},f=(0,n.Z)(i);try{for(f.s();!(c=f.n()).done;)(y=c.value).getResources(y.tileClipper,u,h)}catch(l){f.e(l)}finally{f.f()}if(this._tile.status!==te.INVALID){e.next=7;break}return e.abrupt("return",Promise.resolve([]));case 7:return x=this._fetchResources(s,h,t),e.abrupt("return",Promise.all([].concat((0,M.Z)(x),[r])).then((function(){return v._processFeatures(a.returnedBuckets)})));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){return{signal:e&&e.signal,sourceNameToTileData:this._parseTileData(this._pbfTiles),layers:this._layers,zoom:this._level,sourceNameToTileClipper:this._tileClippers,sourceNameToUniqueSourceLayerBuckets:{},sourceNameToUniqueSourceLayers:{},returnedBuckets:[],layerIdToBucket:{},referencerUIDToReferencedId:new Map}}},{key:"_processLayers",value:function(e){for(var t=e.sourceNameToTileData,r=e.layers,n=e.zoom,a=e.sourceNameToTileClipper,i=e.sourceNameToUniqueSourceLayerBuckets,s=e.sourceNameToUniqueSourceLayers,l=e.returnedBuckets,o=e.layerIdToBucket,u=e.referencerUIDToReferencedId,h=r.length-1;h>=0;h--){var f=r[h];if(!(!this._canParseStyleLayer(f.uid)||f.minzoom&&n<Math.floor(f.minzoom)||f.maxzoom&&n>=f.maxzoom||0===f.type)&&(t[f.source]&&a[f.source])){var c=t[f.source],y=a[f.source],x=f.sourceLayer,v=c[x];if(v){var d=s[f.source];if(d||(d=s[f.source]=new Set),d.add(f.sourceLayer),f.refLayerId)u.set(f.uid,f.refLayerId);else{var p=this._createBucket(f);if(p){p.layerUIDs=[f.uid],p.layerExtent=v.extent,p.tileClipper=y;var g=i[f.source];g||(g=i[f.source]={});var _=g[x];_||(_=g[x]=[]),_.push(p),l.push(p),o[f.id]=p}}}}}}},{key:"_linkReferences",value:function(e){var t=e.layerIdToBucket;e.referencerUIDToReferencedId.forEach((function(e,r){t[e=e]&&t[e].layerUIDs.push(r)}))}},{key:"_filterFeatures",value:function(e){for(var t=e.signal,r=e.sourceNameToTileData,a=e.sourceNameToUniqueSourceLayerBuckets,i=e.sourceNameToUniqueSourceLayers,s=10*this._level,l=10*(this._level+1),u=[],h=[],f=function(){var e=y[c];i[e].forEach((function(t){u.push(t),h.push(e)}))},c=0,y=Object.keys(i);c<y.length;c++)f();for(var x=0;x<u.length;x++){var v=h[x],d=u[x];if(r[v]&&a[v]){var p=r[v][d],g=a[v][d];if(g&&0!==g.length){if((0,o.Hc)(t))return;for(var _=p.getData();_.nextTag(2);){var m=_.getMessage(),I=new V(m,p);m.release();var k=I.values;if(k){var w=k._minzoom;if(w&&w>=l)continue;var Z=k._maxzoom;if(Z&&Z<=s)continue}var b,M=(0,n.Z)(g);try{for(M.s();!(b=M.n()).done;){b.value.pushFeature(I)}}catch(P){M.e(P)}finally{M.f()}}}}}}},{key:"_fetchResources",value:function(e,t,r){var n,a,i=[],s=this._tile.getWorkerTileHandler();for(var l in e.length>0&&(n=s.fetchSprites(e,this._client,r),i.push(n)),t){var o=t[l];o.size>0&&(a=s.fetchGlyphs(this._tile.tileKey,l,o,this._client,r),i.push(a))}return i}},{key:"_processFeatures",value:function(e){var t,r=this,a=e.filter((function(e){return e.hasFeatures()||r._canParseStyleLayer(e.layer.uid)})),i=(0,n.Z)(a);try{for(i.s();!(t=i.n()).done;){var s=t.value;s.processFeatures(s.tileClipper)}}catch(l){i.e(l)}finally{i.f()}return a}},{key:"_parseTileData",value:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var a=n[r],i=e[a],s={};i.next();)if(3===i.tag()){var l=i.getMessage(),o=new E(l);l.release(),s[o.name]=o}else i.skip();t[a]=s}return t}},{key:"_createBucket",value:function(e){switch(e.type){case 0:return null;case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}}},{key:"_createFillBucket",value:function(e){return new j(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new z(e.fillMaterial.getStride()),new S,new F(e.outlineMaterial.getStride()),new S)}},{key:"_createLineBucket",value:function(e){return new q(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new C(e.lineMaterial.getStride()),new S)}},{key:"_createCircleBucket",value:function(e){return new O(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new U(e.circleMaterial.getStride()),new S)}},{key:"_createSymbolBucket",value:function(e){var t=this._tile;return new ee(e,this._level,new N(e.iconMaterial.getStride()),new S,new N(e.textMaterial.getStride()),new S,t.placementEngine,t.getWorkerTileHandler())}}]),e}(),ae=function(){function e(t,r,n,a){(0,i.Z)(this,e),this.status=te.INITIALIZED,this.placementEngine=new b,this.tileKey=t,this.refKeys=r,this._workerTileHandler=n,this._styleRepository=a}return(0,s.Z)(e,[{key:"release",value:function(){this.tileKey="",this.refKeys=null,this.status=te.INITIALIZED,this._workerTileHandler=null}},{key:"parse",value:function(){var e=(0,a.Z)(l.mark((function e(t,r,a){var i,s,h,f,c,y,x,v,d=this;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a&&a.signal,(0,u.pC)(i)&&(s=function e(){i.removeEventListener("abort",e),d.status=te.INVALID},i.addEventListener("abort",s)),e.prev=2,e.next=5,this._parse(t,a);case 5:h=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),!(0,o.D_)(e.t0)){e.next=12;break}throw e.t0;case 12:return e.abrupt("return",{result:[],transferList:[]});case 13:this.status=te.READY,f=[],c=(0,n.Z)(h);try{for(c.s();!(y=c.n()).done;)x=y.value,v=x.serialize(),f.push(v)}catch(l){c.e(l)}finally{c.f()}return e.abrupt("return",{result:f,transferList:f.length<=r&&f});case 18:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"setObsolete",value:function(){this.status=te.INVALID}},{key:"getLayers",value:function(){return this._workerTileHandler.getLayers()}},{key:"getWorkerTileHandler",value:function(){return this._workerTileHandler}},{key:"_parse",value:function(){var e=(0,a.Z)(l.mark((function e(t,r){var n;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sourceName2DataAndRefKey,0!==Object.keys(n).length){e.next=3;break}return e.abrupt("return",[]);case 3:return this.status=te.MODIFIED,e.abrupt("return",new ne(n,this,r.client,this._styleRepository,t.styleLayerUIDs).parse(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),ie=r(30969),se=function(){function e(){(0,i.Z)(this,e),this._spriteInfo={},this._glyphInfo={}}return(0,s.Z)(e,[{key:"reset",value:function(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}},{key:"getLayers",value:function(){var e;return null==(e=this._styleRepository)?void 0:e.layers}},{key:"createTileAndParse",value:function(){var e=(0,a.Z)(l.mark((function e(t,r){var n,a,i,s,u,h,f;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.key,a={},i=0,s=Object.keys(t.sourceName2DataAndRefKey);i<s.length;i++)u=s[i],h=t.sourceName2DataAndRefKey[u],a[u]=h.refKey;return f=new ae(n,a,this,this._styleRepository),e.prev=3,e.next=6,f.parse(t,this._vectorTileLayerMaxBuffers,r);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),f.setObsolete(),f.release(),(0,o.D_)(e.t0)){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateStyle",value:function(e){if(e&&0!==e.length&&this._styleRepository){var t,r=this._styleRepository,a=(0,n.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value,s=i.type,l=i.data;switch(s){case 0:r.setPaintProperties(l.layer,l.paint);break;case 1:r.setLayoutProperties(l.layer,l.layout);break;case 3:r.deleteStyleLayer(l.layer);break;case 2:r.setStyleLayer(l.layer,l.index)}}}catch(o){a.e(o)}finally{a.f()}}}},{key:"setStyle",value:function(e){this._styleRepository=new ie.Z(e.style),this._spriteInfo={},this._glyphInfo={},this._vectorTileLayerMaxBuffers=e.vectorTileLayerMaxBuffers}},{key:"fetchSprites",value:function(e,t,r){var a,i=[],s=this._spriteInfo,l=(0,n.Z)(e);try{for(l.s();!(a=l.n()).done;){var o=a.value;void 0===s[o.name]&&i.push(o)}}catch(u){l.e(u)}finally{l.f()}return 0===i.length?Promise.resolve():t.invoke("getSprites",i,{signal:r&&r.signal}).then((function(e){for(var t in e){var r=e[t];s[t]=r}}))}},{key:"getSpriteItems",value:function(){return this._spriteInfo}},{key:"fetchGlyphs",value:function(e,t,r,n,a){var i=[],s=this._glyphInfo[t];return s?r.forEach((function(e){s[e]||i.push(e)})):(s=this._glyphInfo[t]=[],r.forEach((function(e){return i.push(e)}))),0===i.length?Promise.resolve():n.invoke("getGlyphs",{tileID:e,font:t,codePoints:i},a).then((function(e){for(var t=0;t<e.length;t++)e[t]&&(s[t]=e[t])}))}},{key:"getGlyphItems",value:function(e){return this._glyphInfo[e]}}]),e}()},46618:function(e,t,r){r.d(t,{PF:function(){return a},Ts:function(){return i},Bf:function(){return n},nN:function(){return s}});var n=!0,a=32,i=1.5,s=200},13200:function(e,t,r){r.d(t,{vX:function(){return h},s5:function(){return o},k3:function(){return u},Or:function(){return l}});Number.POSITIVE_INFINITY;var n=Math.PI,a=128/n,i=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function l(e){return s(e*a,256)}function o(e){return s(.7111111111111111*e,256)}function u(e){return Math.log(e)*i}function h(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}}]);
//# sourceMappingURL=6058.efdd0dec.chunk.js.map